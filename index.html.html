
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Margot's Magical Words ✨</title>
<style>
  :root {
    --pink: #ff4081;
    --orange: #ff7043;
    --blue: #42a5f5;
    --green: #66bb6a;
    --purple: #ab47bc;
    --card: #fff3c4;
  }
  body {
    font-family: 'Comic Sans MS', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    background: linear-gradient(180deg, #fceabb 0%, #f8b500 100%);
    margin: 0; padding: 0;
    min-height: 100vh;
    display: grid;
    place-items: center;
  }
  .app {
    background: white;
    border-radius: 20px;
    padding: 20px;
    width: 92%;
    max-width: 460px;
    box-shadow: 0 6px 18px rgba(0,0,0,0.18);
    text-align: center;
  }
  h1 {
    color: var(--pink);
    font-size: 1.9rem;
    margin: 8px 0 6px;
    line-height: 1.2;
  }
  p.sub {
    margin: 0 0 10px;
    color: #444;
  }
  .word-box {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 10px;
    margin: 18px 0 10px 0;
  }
  .word {
    background: var(--card);
    border-radius: 12px;
    padding: 10px 14px;
    font-weight: 700;
    font-size: 1.15rem;
    transition: transform .2s;
    display: inline-flex;
    align-items: center;
    gap: 6px;
  }
  .word:hover { transform: scale(1.06); }
  .phrase {
    margin-top: 6px;
    font-weight: 700;
    color: #5c3b00;
  }
  button {
    border: none; border-radius: 12px;
    padding: 11px 14px;
    margin: 6px 5px;
    font-size: 1rem; font-weight: 700;
    cursor: pointer; color: white;
    box-shadow: 0 3px 0 rgba(0,0,0,.12);
  }
  .generate { background: var(--orange); }
  .speak { background: var(--blue); }
  .copy { background: var(--green); }
  .start-btn { background: var(--purple); font-size: 1.15rem; padding: 14px 20px; }
  .mute { background: #6d6dff; }
  footer {
    font-size: .8rem; color: #666; margin-top: 10px;
  }
  .hidden { display: none; }
</style>
</head>
<body>
  <!-- Welcome Screen -->
  <div id="welcome" class="app">
    <h1>🪄 Welcome to<br/>Margot's Magical Words ✨</h1>
    <p class="sub">Now with <strong>2 characters</strong>, <strong>2 objects</strong>, and <strong>1 place</strong>…</p>
    <p class="sub"><em>and bear of course!</em> 🐻</p>
    <button class="start-btn" onclick="startGame()">Start the Magic ✨</button>
  </div>

  <!-- Main App -->
  <div id="mainApp" class="app hidden">
    <h1>Margot's Magical Words ✨</h1>
    <p class="sub">2 characters • 2 objects • 1 place</p>

    <div class="word-box" id="words">
      <div class="word">—</div>
      <div class="word">—</div>
      <div class="word">—</div>
      <div class="word">—</div>
      <div class="word">—</div>
    </div>
    <div id="alwaysPhrase" class="phrase">…and bear of course!</div>

    <div>
      <button class="generate" onclick="generateWords()">🎲 Generate</button>
      <button class="speak" onclick="speakWords()">🔊 Speak</button>
      <button class="copy" onclick="copyWords()">📋 Copy</button>
    </div>
    <div>
      <button id="muteBtn" class="mute" onclick="toggleMute()">🔊 Music: On</button>
    </div>

    <footer>Made with 💖 for kids • Safe for ages 0–16 • Works offline</footer>
  </div>

<script>
// ---------- Word Data (with Emoji) ----------
const characters = [
  { word: "wizard", emoji: "🧙‍♂️" },
  { word: "astronaut", emoji: "🧑‍🚀" },
  { word: "superhero", emoji: "🦸‍♀️" },
  { word: "detective", emoji: "🕵️‍♂️" },
  { word: "chef", emoji: "👩‍🍳" },
  { word: "scientist", emoji: "👩‍🔬" },
  { word: "pirate", emoji: "🏴‍☠️" },
  { word: "knight", emoji: "🤺" },
  { word: "princess", emoji: "👸" },
  { word: "prince", emoji: "🤴" }
];

const objects = [
  { word: "book", emoji: "📚" },
  { word: "compass", emoji: "🧭" },
  { word: "key", emoji: "🗝️" },
  { word: "telescope", emoji: "🔭" },
  { word: "lantern", emoji: "🏮" },
  { word: "map", emoji: "🗺️" },
  { word: "backpack", emoji: "🎒" },
  { word: "paintbrush", emoji: "🖌️" },
  { word: "pencil", emoji: "✏️" },
  { word: "guitar", emoji: "🎸" }
];

const places = [
  { word: "castle", emoji: "🏰" },
  { word: "forest", emoji: "🌳" },
  { word: "beach", emoji: "🏖️" },
  { word: "space station", emoji: "🛰️" },
  { word: "mountain", emoji: "🏔️" },
  { word: "city", emoji: "🏙️" },
  { word: "island", emoji: "🏝️" },
  { word: "museum", emoji: "🏛️" },
  { word: "school", emoji: "🏫" },
  { word: "zoo", emoji: "🦓" }
];

const ALWAYS_PHRASE = "and bear of course!";

// ---------- Helper Functions ----------
function sampleRandom(arr, n) {
  const copy = [...arr];
  const result = [];
  for (let i = 0; i < n; i++) {
    const index = Math.floor(Math.random() * copy.length);
    result.push(copy.splice(index, 1)[0]);
  }
  return result;
}

function shuffle(a) {
  for (let i = a.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [a[i], a[j]] = [a[j], a[i]];
  }
  return a;
}

// ---------- WebAudio: Magical Background + Sparkle SFX ----------
let audioCtx, bgGain, sfxGain, isMuted = false, bgInterval = null;

function initAudio() {
  audioCtx = new (window.AudioContext || window.webkitAudioContext)();
  bgGain = audioCtx.createGain();
  bgGain.gain.value = 0.12;
  sfxGain = audioCtx.createGain();
  sfxGain.gain.value = 0.25;
  bgGain.connect(audioCtx.destination);
  sfxGain.connect(audioCtx.destination);
  startBackgroundMusic();
}

function playBell(frequency, time, duration=0.6) {
  const osc1 = audioCtx.createOscillator();
  const osc2 = audioCtx.createOscillator();
  const gain = audioCtx.createGain();

  osc1.type = "sine"; osc2.type = "triangle";
  osc1.frequency.setValueAtTime(frequency, time);
  osc2.frequency.setValueAtTime(frequency * 2, time);

  gain.gain.setValueAtTime(0.001, time);
  gain.gain.exponentialRampToValueAtTime(0.7, time + 0.02);
  gain.gain.exponentialRampToValueAtTime(0.0001, time + duration);

  osc1.connect(gain); osc2.connect(gain);
  gain.connect(bgGain);

  osc1.start(time); osc2.start(time);
  osc1.stop(time + duration); osc2.stop(time + duration);
}

function startBackgroundMusic() {
  const base = 523.25; // C5
  const scale = [0, 2, 4, 7, 9].map(s => base * Math.pow(2, s/12));
  if (bgInterval) clearInterval(bgInterval);
  function scheduleBar(startAt) {
    playBell(scale[0], startAt + 0.1, 1.2);
    playBell(scale[2], startAt + 2.0, 1.0);
    playBell(scale[4], startAt + 3.6, 1.2);
    playBell(scale[1], startAt + 5.2, 0.8);
    playBell(scale[3], startAt + 5.5, 0.8);
  }
  let now = audioCtx.currentTime;
  scheduleBar(now);
  bgInterval = setInterval(() => {
    now = audioCtx.currentTime;
    scheduleBar(now);
  }, 6000);
}

function sparkleSfx() {
  const now = audioCtx.currentTime;
  const notes = [880, 1174.66, 1567.98];
  notes.forEach((freq, i) => {
    const osc = audioCtx.createOscillator();
    const g = audioCtx.createGain();
    osc.type = "sine";
    osc.frequency.setValueAtTime(freq, now + i * 0.06);
    g.gain.setValueAtTime(0.0001, now + i * 0.06);
    g.gain.exponentialRampToValueAtTime(0.6, now + i * 0.08);
    g.gain.exponentialRampToValueAtTime(0.0001, now + i * 0.28);
    osc.connect(g); g.connect(sfxGain);
    osc.start(now + i * 0.06);
    osc.stop(now + i * 0.3);
  });
}

function toggleMute() {
  isMuted = !isMuted;
  bgGain.gain.setValueAtTime(isMuted ? 0.0 : 0.12, audioCtx.currentTime);
  document.getElementById("muteBtn").textContent = isMuted ? "🔇 Music: Off" : "🔊 Music: On";
}

// ---------- App Logic ----------
function startGame() {
  document.getElementById('welcome').classList.add('hidden');
  document.getElementById('mainApp').classList.remove('hidden');
  if (!audioCtx) initAudio();
  // First generation on start to show an example
  generateWords();
}

function generateWords() {
  const twoChars = sampleRandom(characters, 2);
  const twoObjs  = sampleRandom(objects, 2);
  const onePlace = sampleRandom(places, 1);
  const all = shuffle([...twoChars, ...twoObjs, ...onePlace]);
  const wordsDiv = document.getElementById('words');
  wordsDiv.innerHTML = all.map(w => `<div class='word'>${w.emoji} ${w.word}</div>`).join('');
  document.getElementById('alwaysPhrase').textContent = "…"+ALWAYS_PHRASE;
  if (audioCtx && audioCtx.state !== "suspended") sparkleSfx();
}

function buildSentence() {
  const words = [...document.querySelectorAll('.word')].map(w => w.textContent.replace(/[^a-zA-Z ]/g, '').trim());
  // Join as a simple sentence and append the fixed phrase
  return words.join(', ') + ' ' + ALWAYS_PHRASE;
}

function speakWords() {
  const sentence = buildSentence();
  const utter = new SpeechSynthesisUtterance(sentence);
  utter.rate = 0.9;
  speechSynthesis.cancel();
  speechSynthesis.speak(utter);
}

function copyWords() {
  const sentence = buildSentence();
  navigator.clipboard.writeText(sentence).then(() => alert('Copied to clipboard!'));
}
</script>
</body>
</html>
